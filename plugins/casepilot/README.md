# CasePilot

智能测试用例生成器。从需求文档自动生成 **混合结构 Markdown** 格式的测试用例（可用 markmap 渲染）。

## 功能特性

- **四阶段渐进式生成**：需求分析 → 测试点生成 → 用例设计 → 智能优化
- **二八法则**：每个需求点生成 3-8 个测试点
- **7 层链式用例结构**：标题 → 模块 → 用例名称 → 前置条件 → 执行步骤 → 预期结果 → 优先级
- **多测试类型**：PRD UI/交互、功能、边界、异常、兼容性、状态机
- **验收标准覆盖**：确保每条验收标准都有对应的测试用例
- **多输入源**：飞书项目单、飞书云文档、本地文件

## 前置要求

### 必需

- Claude Code CLI

### 可选（根据输入源）

| 输入源 | 所需 MCP 服务器 |
|--------|----------------|
| 本地文件 | 无 |
| 飞书项目单 | `lark-prj-remote` |
| 飞书云文档 | `lark-mcp-remote` |

## 使用方法

### 命令方式

```bash
# 从飞书项目单生成
/casepilot:generate https://project.feishu.cn/xxx/story/detail/xxx

# 从飞书云文档生成
/casepilot:generate https://xxx.feishu.cn/docx/xxx

# 从本地文件生成
/casepilot:generate ./docs/requirement.md

# 检查 MCP 配置
/casepilot:check-mcp
```

### 自然语言方式

```
帮我为这个需求生成测试用例：[需求描述]

请根据这个飞书项目单生成 XMind 测试用例：[URL]

为以下功能设计测试点和测试用例：[功能描述]
```

## 四阶段工作流

### 阶段1：需求分析

将需求文档拆分为独立、可测试的需求点。

### 阶段2：测试点生成

基于二八法则，为每个需求点生成 3-8 个测试点。

**测试分类：**
- PRD UI/交互设计测试（P0）
- 功能测试（P0）
- 状态切换测试（P0-P1）
- 边界值测试（P1）
- 异常场景测试（P0-P1）
- 兼容性测试（P1-P2）

### 阶段3：用例设计

为每个测试点设计测试用例，采用链式结构。

### 阶段4：智能优化

验收标准覆盖检查，确保每条验收标准都有对应的测试用例。

## 输出格式

### Markdown 混合结构

```markdown
# 文档标题

## 1. 模块名

### 用例名称
- 前置条件
  - 执行步骤
    - 预期结果
      - P0
```

### 层级格式规范

| 层级 | 内容 | 格式 |
|------|------|------|
| L1 | 文档标题 | `# ` |
| L2 | 模块名 | `## ` |
| L3 | 用例名 | `### ` |
| L4 | 前置条件 | `- ` |
| L5 | 测试步骤 | `  - ` (2空格缩进) |
| L6 | 预期结果 | `    - ` (4空格缩进) |
| L7 | 优先级 | `      - ` (6空格缩进) |

### 输出路径

```
~/Testcase/markmap/{工作项名称}_测试用例_{时间戳}.md
```

### 输出总结

生成完成后会输出：
- 需求摘要（名称、描述、验收标准）
- 验收标准覆盖情况表格
- 测试用例统计（按分类和优先级）
- 文件路径

## 优先级说明

| 优先级 | 重要性 | 适用场景 |
|--------|--------|----------|
| **P0** | 最高 | 核心功能、验收标准相关、主流程、PRD UI/交互核心功能 |
| **P1** | 中等 | 边界条件、配置验证、异常处理、主题/语言切换 |
| **P2** | 较低 | 辅助功能、稳定性测试、极端场景 |

## 常见问题

### Q: MCP 服务未配置怎么办？

运行 `/casepilot:check-mcp` 查看配置状态和指引。

### Q: 可以只使用本地文件吗？

可以。本地文件模式不需要任何 MCP 服务器。

### Q: 生成的 Markdown 文件如何使用？

可用 VS Code markmap 插件或其他 markmap 工具渲染为思维导图。

## 技术来源

本插件的四阶段工作流设计参考自 TestFlow 方法论。

## 许可证

MIT License
